# bootstrap

Первым делом инициализируется **ide\IdeClassLoader**, специальный загрузчик классов самой IDE. Затем загружается класс **ide\Ide** - сердце DevelNext.

# Класс Ide

Данный класс служит мостом ко всем остальным модулям DN. Он наследуется от **php\gui\framework\Application** и напрямую связан с UI. При запуске инициализируется логгер и перехватчик исключений.

![ExceptionHandler](exception_handler.png)

Затем проверяются аргументы командной строки. Если первый аргумент начинается с *develnext://*, то проверка осуществляется при помощи протоколов зарегистрированных в файле *.dn/protocolHandlers*, в ином случае аргумент воспринимается как файл *.dnproject* или *.zip* архив.

Далее загружается  **ide\account\ServiceManager** - класс для работы с различными сервисами DN(управление аккаунтом, загрузка/выгрузка проектов и т.д).

Затем идёт загрузка всех компонентов(расширений, различных компонентов редактора, шаблонов для проекта и т.д). Порядок регистрации такой:

1. Расширения
2. Компоненты редактора
3. Форматы
4. Шаблоны проектов
5. Команды

## Расширения

Базовым классом для всех расширения является **ide\AbstractExtension**. Этот класс имеет следующие методы:

* ```onIdeStart()``` - вызывается при запуске DN

* ```onIdeShutdown()``` - вызывается при завершении работы DN
* ```onRegister()``` - вызывается при регистрации расширения
* ```getDependencies()``` - список зависимостей для расширения

Первым вызывается метод ```getDependencies()``` для того, чтобы зарегистрировать зависимости, перед регистрацией самого расширения. Затем следует вызов ```onRegister()``` а метод ```onIdeStart()``` вызывается после того как зарегистрированы все компоненты.

```getDependencies()``` должен возвращать список имён классов. Данные классы должны быть экземплярами **ide\bundle\AbstractBundle** или **ide\AbstractExtension**.

Зарегистрировать расширение можно при помощи:

```php
ide\Ide::get()->registerExtension(string|AbstractExtension);
```

передав туда имя класса или экземпляр класса **ide\AbstractExtension**.

Список стандартных расширения можно найти в файле *.dn/extensions*.

Подробнее об этом позже...

## Компоненты редактора

Здесь нужно сделать оговорку. Речь идёт о различных полях для редактирования объектов в редакторе(строковые редакторы, числовые редакторы, редактор шрифтов и т.д.).

![Пример](property_values_editor.png)

Такие компоненты наследуются от класса **ide\editors\value\ElementPropertyEditor**, а зарегистрировать их можно при помощи:

```php
ide\editors\value\ElementPropertyEditor::register(ElementPropertyEditor)
```

передав туда экземпляр соответствующего класса.

Список стандартных компонентов редактора можно найти в файле *.dn/propertyValueEditors*.

Подробнее об этом позже...

## Форматы

Форматы служат для добавления различных редакторов(редактора кода, редактора модулей, редактора UI и т.д.).





Продолжение следует...

